from typing import Dict, List, Any
from core.engine import HTTPEngine
from utils.logger import Logger

class ExploitManager:
    def __init__(self, engine: HTTPEngine):
        self.engine = engine
        self.modules = {}

    def register_module(self, name: str, module_class):
        self.modules[name] = module_class(self.engine)

    async def run_exploit(self, module_name: str, target_url: str, **kwargs):
        if module_name not in self.modules:
            Logger.error(f"Module {module_name} not found.")
            return
        
        Logger.info(f"Running exploit module: [bold]{module_name}[/bold]")
        return await self.modules[module_name].run(target_url, **kwargs)

class BaseModule:
    def __init__(self, engine: HTTPEngine):
        self.engine = engine

    async def run(self, target_url: str, **kwargs):
        raise NotImplementedError("Modules must implement the run method.")
